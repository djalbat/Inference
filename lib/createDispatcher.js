"use strict";

var createDispatcher = function createDispatcher(rule) {
  var listeners = [];

  var dispatch = function dispatch(action) {
    var update = rule(action);
    listeners.forEach(function (listener) {
      var ruleNames = listener.ruleNames;

      if (ruleNames.length === 0 || ruleNames.some(function (ruleName) {
        return update[ruleName] !== undefined;
      })) {
        listener(update);
      }
    });
  };

  var subscribe = function subscribe(listener) {
    for (var _len = arguments.length, ruleNames = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      ruleNames[_key - 1] = arguments[_key];
    }

    Object.assign(listener, {
      ruleNames: ruleNames
    });
    listeners.push(listener);
    return function () {
      return unsubscribe(listener);
    };
  };

  var unsubscribe = function unsubscribe(l) {
    listeners = listeners.filter(function (listener) {
      return listener !== l;
    });
  };

  return {
    dispatch: dispatch,
    subscribe: subscribe,
    unsubscribe: unsubscribe
  };
};

module.exports = createDispatcher;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZURpc3BhdGNoZXIuanMiXSwibmFtZXMiOlsiY3JlYXRlRGlzcGF0Y2hlciIsInJ1bGUiLCJsaXN0ZW5lcnMiLCJkaXNwYXRjaCIsImFjdGlvbiIsInVwZGF0ZSIsImZvckVhY2giLCJsaXN0ZW5lciIsInJ1bGVOYW1lcyIsImxlbmd0aCIsInNvbWUiLCJydWxlTmFtZSIsInVuZGVmaW5lZCIsInN1YnNjcmliZSIsIk9iamVjdCIsImFzc2lnbiIsInB1c2giLCJ1bnN1YnNjcmliZSIsImwiLCJmaWx0ZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CLENBQUNDLElBQUQsRUFBVTtBQUNqQyxNQUFJQyxTQUFTLEdBQUcsRUFBaEI7O0FBRUEsTUFBTUMsUUFBUSxHQUFHLFNBQVhBLFFBQVcsQ0FBQ0MsTUFBRCxFQUFZO0FBQzNCLFFBQU1DLE1BQU0sR0FBR0osSUFBSSxDQUFDRyxNQUFELENBQW5CO0FBRUFGLElBQUFBLFNBQVMsQ0FBQ0ksT0FBVixDQUFrQixVQUFDQyxRQUFELEVBQWM7QUFBQSxVQUN0QkMsU0FEc0IsR0FDUkQsUUFEUSxDQUN0QkMsU0FEc0I7O0FBRzlCLFVBQUtBLFNBQVMsQ0FBQ0MsTUFBVixLQUFxQixDQUF0QixJQUE0QkQsU0FBUyxDQUFDRSxJQUFWLENBQWUsVUFBQ0MsUUFBRDtBQUFBLGVBQWVOLE1BQU0sQ0FBQ00sUUFBRCxDQUFOLEtBQXFCQyxTQUFwQztBQUFBLE9BQWYsQ0FBaEMsRUFBZ0c7QUFDOUZMLFFBQUFBLFFBQVEsQ0FBQ0YsTUFBRCxDQUFSO0FBQ0Q7QUFDRixLQU5EO0FBT0QsR0FWRDs7QUFZQSxNQUFNUSxTQUFTLEdBQUcsU0FBWkEsU0FBWSxDQUFDTixRQUFELEVBQTRCO0FBQUEsc0NBQWRDLFNBQWM7QUFBZEEsTUFBQUEsU0FBYztBQUFBOztBQUM1Q00sSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNSLFFBQWQsRUFBd0I7QUFDdEJDLE1BQUFBLFNBQVMsRUFBVEE7QUFEc0IsS0FBeEI7QUFJQU4sSUFBQUEsU0FBUyxDQUFDYyxJQUFWLENBQWVULFFBQWY7QUFFQSxXQUFRO0FBQUEsYUFBTVUsV0FBVyxDQUFDVixRQUFELENBQWpCO0FBQUEsS0FBUjtBQUNELEdBUkQ7O0FBVUEsTUFBTVUsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBQ0MsQ0FBRCxFQUFPO0FBQ3pCaEIsSUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNpQixNQUFWLENBQWlCLFVBQUNaLFFBQUQ7QUFBQSxhQUFlQSxRQUFRLEtBQUtXLENBQTVCO0FBQUEsS0FBakIsQ0FBWjtBQUNELEdBRkQ7O0FBSUEsU0FBTztBQUFFZixJQUFBQSxRQUFRLEVBQVJBLFFBQUY7QUFBWVUsSUFBQUEsU0FBUyxFQUFUQSxTQUFaO0FBQXVCSSxJQUFBQSxXQUFXLEVBQVhBO0FBQXZCLEdBQVA7QUFDRCxDQTlCRDs7QUFnQ0FHLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQnJCLGdCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBjcmVhdGVEaXNwYXRjaGVyID0gKHJ1bGUpID0+IHtcbiAgbGV0IGxpc3RlbmVycyA9IFtdO1xuXG4gIGNvbnN0IGRpc3BhdGNoID0gKGFjdGlvbikgPT4ge1xuICAgIGNvbnN0IHVwZGF0ZSA9IHJ1bGUoYWN0aW9uKTtcblxuICAgIGxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4ge1xuICAgICAgY29uc3QgeyBydWxlTmFtZXMgfSA9IGxpc3RlbmVyO1xuXG4gICAgICBpZiAoKHJ1bGVOYW1lcy5sZW5ndGggPT09IDApIHx8IHJ1bGVOYW1lcy5zb21lKChydWxlTmFtZSkgPT4gKHVwZGF0ZVtydWxlTmFtZV0gIT09IHVuZGVmaW5lZCkpKSB7XG4gICAgICAgIGxpc3RlbmVyKHVwZGF0ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgY29uc3Qgc3Vic2NyaWJlID0gKGxpc3RlbmVyLCAuLi5ydWxlTmFtZXMpID0+IHtcbiAgICBPYmplY3QuYXNzaWduKGxpc3RlbmVyLCB7XG4gICAgICBydWxlTmFtZXNcbiAgICB9KTtcblxuICAgIGxpc3RlbmVycy5wdXNoKGxpc3RlbmVyKTtcblxuICAgIHJldHVybiAoKCkgPT4gdW5zdWJzY3JpYmUobGlzdGVuZXIpKTtcbiAgfTtcblxuICBjb25zdCB1bnN1YnNjcmliZSA9IChsKSA9PiB7XG4gICAgbGlzdGVuZXJzID0gbGlzdGVuZXJzLmZpbHRlcigobGlzdGVuZXIpID0+IChsaXN0ZW5lciAhPT0gbCkpO1xuICB9O1xuXG4gIHJldHVybiB7IGRpc3BhdGNoLCBzdWJzY3JpYmUsIHVuc3Vic2NyaWJlIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZURpc3BhdGNoZXI7XG4iXX0=