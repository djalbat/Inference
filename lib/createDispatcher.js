'use strict';

var createDispatcher = function createDispatcher(rule) {
  var listeners = [];

  var dispatch = function dispatch(action) {
    var update = rule(action);
    listeners.forEach(function (listener) {
      var ruleNames = listener.ruleNames;

      if (ruleNames.length === 0 || ruleNames.some(function (ruleName) {
        return update[ruleName] !== undefined;
      })) {
        listener(update);
      }
    });
  };

  var subscribe = function subscribe(listener) {
    for (var _len = arguments.length, ruleNames = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      ruleNames[_key - 1] = arguments[_key];
    }

    Object.assign(listener, {
      ruleNames: ruleNames
    });
    listeners.push(listener);
    return function () {
      return unsubscribe(listener);
    };
  };

  var unsubscribe = function unsubscribe(l) {
    listeners = listeners.filter(function (listener) {
      return listener !== l;
    });
  };

  return {
    dispatch: dispatch,
    subscribe: subscribe,
    unsubscribe: unsubscribe
  };
};

module.exports = createDispatcher;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZURpc3BhdGNoZXIuanMiXSwibmFtZXMiOlsiY3JlYXRlRGlzcGF0Y2hlciIsInJ1bGUiLCJsaXN0ZW5lcnMiLCJkaXNwYXRjaCIsImFjdGlvbiIsInVwZGF0ZSIsImZvckVhY2giLCJsaXN0ZW5lciIsInJ1bGVOYW1lcyIsImxlbmd0aCIsInNvbWUiLCJydWxlTmFtZSIsInVuZGVmaW5lZCIsInN1YnNjcmliZSIsIk9iamVjdCIsImFzc2lnbiIsInB1c2giLCJ1bnN1YnNjcmliZSIsImwiLCJmaWx0ZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CLENBQUNDLElBQUQsRUFBVTtBQUNqQyxNQUFJQyxTQUFTLEdBQUcsRUFBaEI7O0FBRUEsTUFBTUMsUUFBUSxHQUFHLFNBQVhBLFFBQVcsQ0FBQ0MsTUFBRCxFQUFZO0FBQzNCLFFBQU1DLE1BQU0sR0FBR0osSUFBSSxDQUFDRyxNQUFELENBQW5CO0FBRUFGLElBQUFBLFNBQVMsQ0FBQ0ksT0FBVixDQUFrQixVQUFDQyxRQUFELEVBQWM7QUFBQSxVQUN0QkMsU0FEc0IsR0FDUkQsUUFEUSxDQUN0QkMsU0FEc0I7O0FBRzlCLFVBQUtBLFNBQVMsQ0FBQ0MsTUFBVixLQUFxQixDQUF0QixJQUE0QkQsU0FBUyxDQUFDRSxJQUFWLENBQWUsVUFBQ0MsUUFBRDtBQUFBLGVBQWVOLE1BQU0sQ0FBQ00sUUFBRCxDQUFOLEtBQXFCQyxTQUFwQztBQUFBLE9BQWYsQ0FBaEMsRUFBZ0c7QUFDOUZMLFFBQUFBLFFBQVEsQ0FBQ0YsTUFBRCxDQUFSO0FBQ0Q7QUFDRixLQU5EO0FBT0QsR0FWRDs7QUFZQSxNQUFNUSxTQUFTLEdBQUcsU0FBWkEsU0FBWSxDQUFDTixRQUFELEVBQTRCO0FBQUEsc0NBQWRDLFNBQWM7QUFBZEEsTUFBQUEsU0FBYztBQUFBOztBQUM1Q00sSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNSLFFBQWQsRUFBd0I7QUFDdEJDLE1BQUFBLFNBQVMsRUFBVEE7QUFEc0IsS0FBeEI7QUFJQU4sSUFBQUEsU0FBUyxDQUFDYyxJQUFWLENBQWVULFFBQWY7QUFFQSxXQUFRO0FBQUEsYUFBTVUsV0FBVyxDQUFDVixRQUFELENBQWpCO0FBQUEsS0FBUjtBQUNELEdBUkQ7O0FBVUEsTUFBTVUsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBQ0MsQ0FBRCxFQUFPO0FBQ3pCaEIsSUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNpQixNQUFWLENBQWlCLFVBQUNaLFFBQUQ7QUFBQSxhQUFlQSxRQUFRLEtBQUtXLENBQTVCO0FBQUEsS0FBakIsQ0FBWjtBQUNELEdBRkQ7O0FBSUEsU0FBTztBQUFFZixJQUFBQSxRQUFRLEVBQVJBLFFBQUY7QUFBWVUsSUFBQUEsU0FBUyxFQUFUQSxTQUFaO0FBQXVCSSxJQUFBQSxXQUFXLEVBQVhBO0FBQXZCLEdBQVA7QUFDRCxDQTlCRDs7QUFnQ0FHLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQnJCLGdCQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgY3JlYXRlRGlzcGF0Y2hlciA9IChydWxlKSA9PiB7XG4gIGxldCBsaXN0ZW5lcnMgPSBbXTtcblxuICBjb25zdCBkaXNwYXRjaCA9IChhY3Rpb24pID0+IHtcbiAgICBjb25zdCB1cGRhdGUgPSBydWxlKGFjdGlvbik7XG5cbiAgICBsaXN0ZW5lcnMuZm9yRWFjaCgobGlzdGVuZXIpID0+IHtcbiAgICAgIGNvbnN0IHsgcnVsZU5hbWVzIH0gPSBsaXN0ZW5lcjtcblxuICAgICAgaWYgKChydWxlTmFtZXMubGVuZ3RoID09PSAwKSB8fCBydWxlTmFtZXMuc29tZSgocnVsZU5hbWUpID0+ICh1cGRhdGVbcnVsZU5hbWVdICE9PSB1bmRlZmluZWQpKSkge1xuICAgICAgICBsaXN0ZW5lcih1cGRhdGUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIGNvbnN0IHN1YnNjcmliZSA9IChsaXN0ZW5lciwgLi4ucnVsZU5hbWVzKSA9PiB7XG4gICAgT2JqZWN0LmFzc2lnbihsaXN0ZW5lciwge1xuICAgICAgcnVsZU5hbWVzXG4gICAgfSk7XG5cbiAgICBsaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG5cbiAgICByZXR1cm4gKCgpID0+IHVuc3Vic2NyaWJlKGxpc3RlbmVyKSk7XG4gIH07XG5cbiAgY29uc3QgdW5zdWJzY3JpYmUgPSAobCkgPT4ge1xuICAgIGxpc3RlbmVycyA9IGxpc3RlbmVycy5maWx0ZXIoKGxpc3RlbmVyKSA9PiAobGlzdGVuZXIgIT09IGwpKTtcbiAgfTtcblxuICByZXR1cm4geyBkaXNwYXRjaCwgc3Vic2NyaWJlLCB1bnN1YnNjcmliZSB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVEaXNwYXRjaGVyO1xuIl19